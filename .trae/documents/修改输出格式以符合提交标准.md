# 修改输出格式以符合提交标准

我已详细对比了 `E1594609968101 (2).md` 中的目标格式与当前的输出格式，发现主要差异在于**坐标系定义**和**JSON结构**。

## 差异总结

1.  **JSON 结构**:
    *   **目标**: `{"estimateCode": "...", "solutionArray": [[ {Vehicle1}, {Vehicle2} ]] }` (注意 `solutionArray` 是一个包含列表的列表)。
    *   **现状**: `solutionArray` 结构可能不一致，且部分字段缺失。

2.  **坐标系 (关键差异)**:
    *   **目标**:
        *   **坐标原点**: 车厢**中心** (Center)。
        *   **坐标轴**:
            *   `x`: 对应车厢**宽度** (Width) 轴。
            *   `y`: 对应车厢**高度** (Height) 轴。
            *   `z`: 对应车厢**长度** (Length) 轴。
        *   **值域**: 包含负值 (例如 `z` 范围约为 `[-L/2, L/2]`)。
    *   **现状**:
        *   **坐标原点**: 车厢**角点** (Corner, 0,0,0)。
        *   **坐标轴**: `x`=Length, `y`=Width, `z`=Height。

3.  **字段名称**:
    *   目标需要 `truckTypeId` (如 42001) 和 `truckTypeCode` (如 CT03)。
    *   需要 `direction` 字段 (100, 200 等)。

## 修改计划

我将直接修改 `main.py` 中的 `solve_single_instance` 函数（该函数负责生成结果 JSON），不再依赖 `convert_results.py`。

### 1. 坐标转换逻辑
在保存结果时，将内部坐标 `(pi.x, pi.y, pi.z)` 转换为目标坐标 `(out_x, out_y, out_z)`：
*   `out_z (Length Axis)` = `pi.x` + `pi.lx/2` - `Vehicle.L/2`
    *   (内部 X 是 Length，转换为目标 Z)
*   `out_x (Width Axis)` = `pi.y` + `pi.ly/2` - `Vehicle.W/2`
    *   (内部 Y 是 Width，转换为目标 X)
*   `out_y (Height Axis)` = `pi.z` + `pi.lz/2` - `Vehicle.H/2`
    *   (内部 Z 是 Height，转换为目标 Y)

### 2. 方向 (Direction) 映射
根据箱子尺寸推断方向代码：
*   如果 `(pi.lx, pi.ly, pi.lz)` == `(Item.l, Item.w, Item.h)` -> `100` (正常)
*   如果 `(pi.lx, pi.ly, pi.lz)` == `(Item.w, Item.l, Item.h)` -> `200` (水平旋转 90 度)
*   其他情况对应 300-600 (本算法目前主要支持 100/200，若有立放则映射相应代码)。

### 3. JSON 结构调整
*   确保 `solutionArray` 包裹在双重列表中：`[ [ ...vehicles... ] ]`。
*   填充 `piece`, `volume` (总物品体积), `weight` (总物品重量) 等统计字段。

### 4. 验证
*   使用 `reduce_E1594609968101.txt` 重新运行。
*   检查生成的 JSON 是否符合上述所有特征。
